<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Calendário de Reservas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 30px auto;
      padding: 20px;
      background: #fff;
      color: #333;
    }
    h2 {
      text-align: center;
    }
    .calendar {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }
    th, td {
      text-align: center;
      padding: 6px;
      border: 1px solid #ccc;
    }
    td.disabled {
      background-color: #eee;
      color: #999;
    }
    td.available:hover {
      background-color: #cce7ff;
      cursor: pointer;
    }
    td.selected {
      background-color: #007bff;
      color: white;
    }
    .form-group {
      margin: 10px 0;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 10px;
      width: 100%;
      font-size: 16px;
      cursor: pointer;
      margin-top: 15px;
    }
    select, input {
      width: 100%;
      padding: 6px;
    }
    .nav {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>Calendário de Reservas</h2>

  <div class="form-group">
    <label>Hóspedes (máx. 12):</label>
    <input type="number" id="hospedes" min="1" max="12" value="2">
  </div>

  <div class="form-group">
    <label>Pets:</label>
    <input type="number" id="pets" min="0" value="0">
  </div>

  <div class="calendar">
    <div class="nav">
      <button onclick="prevMonth()">&#8592;</button>
      <span id="monthYear"></span>
      <button onclick="nextMonth()">&#8594;</button>
    </div>
    <table id="calendar"></table>
  </div>

  <div class="form-group">
    <p><strong>Entrada:</strong> <span id="checkinDisplay">--</span></p>
    <p><strong>Saída:</strong> <span id="checkoutDisplay">--</span></p>
    <p><strong>Total:</strong> R$<span id="total">0</span> (<span id="noites">0</span> noites)</p>
  </div>

  <button onclick="clearSelection()">Limpar Seleção</button>
  <button onclick="enviarWhatsApp()">RESERVAR</button>

  <script>
    const precoBase = 1900;
    const taxaHospedeExtra = 150;
    const taxaPet = 150;
    const calendario = document.getElementById("calendar");
    const monthYear = document.getElementById("monthYear");

    let dataAtual = new Date();
    let dataSelecionadaInicio = null;
    let dataSelecionadaFim = null;

    function renderCalendar() {
      calendario.innerHTML = "";
      const ano = dataAtual.getFullYear();
      const mes = dataAtual.getMonth();
      monthYear.innerText = new Date(ano, mes).toLocaleString("pt-BR", { month: "long", year: "numeric" });

      const primeiroDia = new Date(ano, mes, 1).getDay();
      const diasNoMes = new Date(ano, mes + 1, 0).getDate();

      let html = "<tr>";
      ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"].forEach(d => html += `<th>${d}</th>`);
      html += "</tr><tr>";

      for (let i = 0; i < primeiroDia; i++) html += "<td></td>";

      for (let dia = 1; dia <= diasNoMes; dia++) {
        const data = new Date(ano, mes, dia);
        const hoje = new Date();
        hoje.setHours(0,0,0,0);
        let classe = "available";
        if (data < hoje) classe = "disabled";

        html += `<td class="${classe}" data-date="${data.toISOString()}">${dia}</td>`;
        if ((primeiroDia + dia) % 7 === 0) html += "</tr><tr>";
      }

      calendario.innerHTML = html;

      document.querySelectorAll("td.available").forEach(td => {
        td.onclick = () => selecionarData(new Date(td.dataset.date));
      });
    }

    function selecionarData(data) {
      if (!dataSelecionadaInicio || (dataSelecionadaInicio && dataSelecionadaFim)) {
        dataSelecionadaInicio = data;
        dataSelecionadaFim = null;
      } else if (data > dataSelecionadaInicio) {
        const dias = (data - dataSelecionadaInicio) / (1000 * 60 * 60 * 24);
        if (dias < 2) {
          alert("Estadia mínima de 2 noites.");
          return;
        }
        dataSelecionadaFim = data;
      }

      atualizarSelecao();
    }

    function atualizarSelecao() {
      document.querySelectorAll("td").forEach(td => td.classList.remove("selected"));
      if (dataSelecionadaInicio) {
        const inicio = new Date(dataSelecionadaInicio);
        const fim = dataSelecionadaFim ? new Date(dataSelecionadaFim) : inicio;
        document.querySelectorAll("td.available").forEach(td => {
          const data = new Date(td.dataset.date);
          if (data >= inicio && data <= fim) td.classList.add("selected");
        });

        document.getElementById("checkinDisplay").innerText = inicio.toLocaleDateString();
        document.getElementById("checkoutDisplay").innerText = dataSelecionadaFim ? fim.toLocaleDateString() : "--";

        calcularTotal();
      }
    }

    function calcularTotal() {
      if (!dataSelecionadaInicio || !dataSelecionadaFim) return;

      const dias = (dataSelecionadaFim - dataSelecionadaInicio) / (1000 * 60 * 60 * 24);
      const hospedes = parseInt(document.getElementById("hospedes").value) || 0;
      const pets = parseInt(document.getElementById("pets").value) || 0;

      let total = precoBase * dias;
      if (hospedes > 10) total += (hospedes - 10) * taxaHospedeExtra * dias;
      total += pets * taxaPet;

      document.getElementById("total").innerText = total.toLocaleString();
      document.getElementById("noites").innerText = dias;
    }

    function clearSelection() {
      dataSelecionadaInicio = null;
      dataSelecionadaFim = null;
      document.getElementById("checkinDisplay").innerText = "--";
      document.getElementById("checkoutDisplay").innerText = "--";
      document.getElementById("total").innerText = "0";
      document.getElementById("noites").innerText = "0";
      atualizarSelecao();
    }

    function prevMonth() {
      dataAtual.setMonth(dataAtual.getMonth() - 1);
      renderCalendar();
      clearSelection();
    }

    function nextMonth() {
      dataAtual.setMonth(dataAtual.getMonth() + 1);
      renderCalendar();
      clearSelection();
    }

    function enviarWhatsApp() {
      if (!dataSelecionadaInicio || !dataSelecionadaFim) {
        alert("Por favor, selecione check-in e check-out.");
        return;
      }

      const checkin = dataSelecionadaInicio.toLocaleDateString();
      const checkout = dataSelecionadaFim.toLocaleDateString();
      const hospedes = document.getElementById("hospedes").value;
      const pets = document.getElementById("pets").value;
      const total = document.getElementById("total").innerText;

      const msg = `Olá! Gostaria de reservar:\nCheck-in: ${checkin}\nCheck-out: ${checkout}\nHóspedes: ${hospedes}\nPets: ${pets}\nValor total: R$${total}`;
      window.open(`https://wa.me/5511991120189?text=${encodeURIComponent(msg)}`);
    }

    renderCalendar();
  </script>
</body>
</html>
